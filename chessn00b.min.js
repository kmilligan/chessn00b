var BoardFactory;
(function(){"function"!==typeof Object.create&&(Object.create=function(b){function a(){}a.prototype=b;return new a});var q={R:"\u2656",N:"\u2658",B:"\u2657",Q:"\u2655",K:"\u2654",P:"\u2659",r:"\u265c",n:"\u265e",b:"\u265d",q:"\u265b",k:"\u265a",p:"\u265f",isWhite:function(b){return 91>b.charCodeAt(0)?!0:!1},getColor:function(b){return this.isWhite(b)?g.white:g.black}},s={1:"a",2:"b",3:"c",4:"d",5:"e",6:"f",7:"g",8:"h",a:"1",b:"2",c:"3",d:"4",e:"5",f:"6",g:"7",h:"8",name:function(b,a){return s[b]+
a},coords:function(b){return{file:parseInt(s[b.substr(0,1)],10),rank:parseInt(b.substr(1,1),10)}}},g={white:1,black:-1},r={init:function(b,a){this.file=b;this.rank=a;this.color=0;this.name=s[b]+a;this.piece="";var c=0==b%2,d=0==a%2;if(!c&&d||c&&!d)this.color=1;return this},setPiece:function(b){if("undefined"===q[b])throw Error("Invalid piece");this.piece=b},removePiece:function(){this.piece=""},hasPiece:function(){return""==this.piece?!1:!0},getPiece:function(){return this.piece},isWhite:function(){return 1==
this.color?!0:!1}},u={init:function(){this.colorToMove=g.white;this.enpassantTarget=this.castlingOptions="-";this.fullMoveNumber=this.halfMoveClock=0;this.squares=[];for(var b=1;9>b;b++)for(var a=1;9>a;a++)1==a&&(this.squares[b]=[]),this.squares[b][a]=Object.create(r).init(b,a);return this},setFEN:function(b){b=b.split(" ");for(var a=b[0].split("/"),c=8;0<c;c--)this.setRankFEN(c,a[8-c]);this.colorToMove="w"==b[1]?g.white:g.black;b[2]&&(this.castlingOptions=b[2]);b[3]&&(this.enpassantTarget=b[3]);
"undefined"!=typeof b[4]&&(this.halfMoveClock=parseInt(b[4],10));"undefined"!=typeof b[5]&&(this.fullMoveNumber=parseInt(b[5],10))},setRankFEN:function(b,a){var c=a.split(""),d=1,e;for(e in c){if(8<d||" "==c[e])break;if(q[c[e]])this.setPiece(c[e],d,b),d++;else for(;0<c[e];)this.removePiece(d,b),c[e]--,d++}},getColorToMove:function(){return this.colorToMove},incrementMove:function(){this.colorToMove==g.white?this.colorToMove=g.black:(this.colorToMove=g.white,this.fullMoveNumber++)},setPiece:function(b,
a,c){this.squares[a][c].setPiece(b)},removePiece:function(b,a){this.squares[b][a].removePiece()},hasPiece:function(b,a){return this.squares[b][a].hasPiece()},getPiece:function(b,a){return this.squares[b][a].getPiece()},getSquare:function(b,a){"undefined"==typeof a&&"string"==typeof b&&(a=b.substr(1,1),b=s[b.substr(0,1)]);return this.squares[b][a]},dump:function(){console.log("-----------------");for(var b=8;0<b;b--){for(var a="|",c=1;9>c;c++)a=this.squares[c][b].hasPiece()?a+this.squares[c][b].getPiece():
a+" ",a+="|";console.log(a);console.log("-----------------")}}};BoardFactory=function(){return{create:function(){return Object.create(u).init()},getPieceMap:function(){return q},getFileMap:function(){return s},getColorMap:function(){return g}}}()})();
(function(q){q.fn.chessn00b=function(b){b||(b={});if("string"==typeof b&&1==this.length&&this[0].displayboard)switch(b){case "fen":return this[0].displayboard.getFEN();default:return"unsupported option"}return this.each(function(){if(!this.displayboard){var a="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";b.fen&&(a=b.fen);b.element=q(this);this.displayboard=Object.create(u).init(b);this.displayboard.setFEN(a)}})};var s=BoardFactory.getPieceMap(),g={"rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR":["e7e5"],
"rnbqkbnr/pppppppp/8/8/3P4/8/PPP1PPPP/RNBQKBNR":["g8f6"],"rnbqkbnr/pppppppp/8/8/2P5/8/PP1PPPPP/RNBQKBNR":["g8f6"],"rnbqkbnr/pppp1ppp/8/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R":["b8c6"],"rnbqkb1r/pppppppp/5n2/8/2PP4/8/PP2PPPP/RNBQKBNR":["g7g6"]},r={init:function(b){this.square=b;this.element=q('<div class="chessn00b-square">&nbsp;</div>');this.element[0].displaySquare=this;this.element.attr("rel",this.square.name);this.element.addClass(this.square.color?"chessn00b-light-square":"chessn00b-dark-square");return this},
update:function(){this.square.hasPiece()?this.element.html(s[this.square.getPiece()]):this.element.html("&nbsp;")},lite:function(){this.element.addClass("chessn00b-square-lit")},unlite:function(){this.element.removeClass("chessn00b-square-lit")},toggleLite:function(){this.element.hasClass("chessn00b-square-lit")?this.unlite():this.lite()}},u={init:function(b){if(!b||!b.element)throw Error('Missing options; requires at least "element" to attach to.');"undefined"===typeof b.playGame&&(b.playGame=!0);
this.element=b.element;this.board=BoardFactory.create();this.engine=EngineFactory.create(this.board);this.playGame=b.playGame;this.lastClickedSquare=null;this.displaySquares=[];this.thinking=!1;this.id="board"+Math.floor(1E6*Math.random());this.element.addClass(this.id);for(b=1;9>b;b++)for(var a=1;9>a;a++)1==a&&(this.displaySquares[b]=[]),this.displaySquares[b][a]=Object.create(r).init(this.board.squares[b][a]);this.createDisplay();return this},createDisplay:function(){for(var b=8;0<b;b--){for(var a=
q('<div class="chessn00b-rank" rel="'+b+'"></div>'),c=1;9>c;c++)a.append(this.displaySquares[c][b].element);this.element.append(a)}this.element.append('<div class="chessn00b-status"><span class="illegal-move">Illegal move. </span><span class="your-move">Your move</span><span class="game-over">Game Over. </span><span class="you-win">You win!</span><span class="you-lose">You win!</span><span class="thinking">Thinking...</span></div>');this.element.find(".illegal-move").hide();this.element.find(".thinking").hide();
this.element.find(".game-over").hide();this.element.find(".you-lose").hide();this.element.find(".you-win").hide();this.playGame||this.element.find(".your-move").hide();this.autosetHeight();var d=this;this.element.on("click",".chessn00b-square",function(){d.squareClicked(q(this));return!1})},autosetHeight:function(){var b=this.displaySquares[1][1].element.width();"undefined"==typeof this.dynCSS&&(this.dynCSS=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(this.dynCSS));
b="."+this.id+" .chessn00b-square { font-size: "+Math.ceil(.82*b)+"px;  height: "+b+"px;  line-height: "+b+"px; }";this.dynCSS.styleSheet?this.dynCSS.styleSheet.cssText=b:this.dynCSS.innerHTML=b},squareClicked:function(b){this.thinking||(this.element.find(".illegal-move").hide(),this.lastClickedSquare?b[0]==this.lastClickedSquare?(this.lastClickedSquare.displaySquare.unlite(),this.lastClickedSquare=null):(this.lastClickedSquare.displaySquare.unlite(),b=""+this.lastClickedSquare.displaySquare.square.name+
b[0].displaySquare.square.name,this.engine.isValidMove(b)?(this.engine.move(b),this.update(),this.lastClickedSquare=null,this.playGame&&this.autoMove()):(this.element.find(".illegal-move").show(),this.lastClickedSquare=null)):(b[0].displaySquare.lite(),this.lastClickedSquare=b[0]))},autoMove:function(){this.thinking=!0;this.element.find(".your-move").hide();this.element.find(".thinking").show();var b=this;setTimeout(function(){var a;if(b.engine.blackInCheckmate())b.thinking=!1,b.element.find(".thinking").hide(),
b.element.find(".game-over").show(),b.element.find(".you-win").show();else{if(a=g[b.getFEN()]){var c=Math.round(Math.random()*(a.length-1));a=a[c];console.log("book move used")}else a=b.engine.getBestMoveForBlack();b.engine.move(a);b.thinking=!1;b.element.find(".thinking").hide();b.update();b.engine.whiteInCheckmate()?(b.element.find(".game-over").show(),b.element.find(".you-lose").show()):b.element.find(".your-move").show()}},0)},setFEN:function(b){this.board.setFEN(b);this.update()},getFEN:function(){return this.engine.getPositionFEN()},
update:function(){for(var b=1;9>b;b++)for(var a=1;9>a;a++)this.displaySquares[b][a].update()}}})(jQuery);if("undefined"===typeof BoardFactory)throw console&&console.log("Missing the BoardFactory!"),Error("Missing the BoardFactory!");var EngineFactory;
(function(){var q=BoardFactory.getPieceMap(),s=BoardFactory.getColorMap(),g=BoardFactory.getFileMap(),r={init:function(a){this.board=a;this.resetCaches();return this},resetCaches:function(){this.whiteCoveredSquares=[];this.blackCoveredSquares=[];this.blackDynamicValue=this.whiteDynamicValue=this.blackStaticValue=this.whiteStaticValue=0;this.cachedPositionFEN=null;this.validWhiteMoves=[];this.validBlackMoves=[]},getWhitesCoveredSquares:function(){this.determineCoveredSquares(!0);return this.whiteCoveredSquares},
getBlacksCoveredSquares:function(){this.determineCoveredSquares(!1);return this.blackCoveredSquares},getValidMovesForWhite:function(){this.determineValidMoves(!0);return this.validWhiteMoves},getValidMovesForBlack:function(){this.determineValidMoves(!1);return this.validBlackMoves},determineValidMoves:function(a){if(!(a&&0<this.validWhiteMoves.length||!a&&0<this.validBlackMoves.length)){a&&(this.validWhiteMoves=[]);a||(this.validBlackMoves=[]);for(var c,d,b,f,m=1;9>m;m++)for(var l=1;9>l;l++)if(this.board.hasPiece(m,
l)&&(c=g.name(m,l),b=q.isWhite(this.board.getPiece(m,l)),b==a)){f=this.getValidMovesForSquare(m,l);for(var k=0;k<f.length;k++)d=""+c+f[k],b?this.validWhiteMoves.push(d):this.validBlackMoves.push(d)}}},getValidMovesForSquare:function(a,c){var d=[];if(!this.board.hasPiece(a,c))return d;var b=this.board.getPiece(a,c),f=q.isWhite(b),m="k"==b||"K"==b?!0:!1,b="p"==b||"P"==b?!0:!1,l=g.name(a,c),k=this.getPositionFEN(),h=EngineFactory.create(),n=this.getCoveredSquares(a,c);if(0==n.length)return d;for(var p,
s,t,r=0;r<n.length;r++)p=g[n[r].substr(0,1)],s=n[r].substr(1,1),t=this.board.hasPiece(p,s),p=this.board.getPiece(p,s),t&&q.isWhite(p)==f||b&&!t||(h.setFEN(k),t=""+l+n[r],h.move(t,!0),f&&h.whiteInCheck()||!f&&h.blackInCheck()||d.push(n[r]));b&&(f?8>c&&!this.board.hasPiece(a,c+1)&&(h.setFEN(k),t=""+l+g.name(a,c+1),h.move(t,!0),h.whiteInCheck()||d.push(g.name(a,c+1)),2!=c||this.board.hasPiece(a,c+2)||(h.setFEN(k),t=""+l+g.name(a,c+2),h.move(t,!0),h.whiteInCheck()||d.push(g.name(a,c+2)))):1<c&&!this.board.hasPiece(a,
c-1)&&(h.setFEN(k),t=""+l+g.name(a,c-1),h.move(t,!0),h.blackInCheck()||d.push(g.name(a,c-1)),7!=c||this.board.hasPiece(a,c-2)||(h.setFEN(k),t=""+l+g.name(a,c-2),h.move(t,!0),h.blackInCheck()||d.push(g.name(a,c-2)))));m&&(f&&!this.whiteInCheck()?(!(0<=this.board.castlingOptions.indexOf("K"))||this.board.hasPiece(a+1,c)||this.isSquareAttackedByBlack(a+1,c)||this.board.hasPiece(a+2,c)||this.isSquareAttackedByBlack(a+2,c)||d.push(g.name(a+2,c)),!(0<=this.board.castlingOptions.indexOf("Q"))||this.board.hasPiece(a-
1,c)||this.isSquareAttackedByBlack(a-1,c)||this.board.hasPiece(a-2,c)||this.isSquareAttackedByBlack(a-2,c)||d.push(g.name(a-2,c))):f||this.blackInCheck()||(!(0<=this.board.castlingOptions.indexOf("k"))||this.board.hasPiece(a+1,c)||this.isSquareAttackedByWhite(a+1,c)||this.board.hasPiece(a+2,c)||this.isSquareAttackedByWhite(a+2,c)||d.push(g.name(a+2,c)),!(0<=this.board.castlingOptions.indexOf("q"))||this.board.hasPiece(a-1,c)||this.isSquareAttackedByWhite(a-1,c)||this.board.hasPiece(a-2,c)||this.isSquareAttackedByWhite(a-
2,c)||d.push(g.name(a-2,c))));return d},isValidMove:function(a,c){var d,b;"object"==typeof a?(d=a,b=g.name(c.file,c.rank)):(d=g.coords(a.substr(0,2)),b=a.substr(2,2));if(!this.board.hasPiece(d.file,d.rank)||q.getColor(this.board.getPiece(d.file,d.rank))!=this.board.getColorToMove())return!1;d=this.getValidMovesForSquare(d.file,d.rank);for(var f=0;f<d.length;f++)if(d[f]===b)return!0;return!1},determineCoveredSquares:function(a){if(!(a&&0<this.whiteCoveredSquares.length||!a&&0<this.blackCoveredSquares.legnth)){a&&
(this.whiteCoveredSquares=[]);a||(this.blackCoveredSquares=[]);for(var c,b=1;9>b;b++)for(var e=1;9>e;e++)if(this.board.hasPiece(b,e)){var f=q.isWhite(this.board.getPiece(b,e));if(f==a){c=this.getCoveredSquares(b,e);var g=this.blackCoveredSquares;f&&(g=this.whiteCoveredSquares);for(f=0;f<c.length;f++)g.push(c[f])}}}},getCoveredSquares:function(a,c){var b;"object"==typeof a?(b=a.file,c=a.rank):b=a;var e=[],f=[];switch(this.board.getPiece(b,c)){case "K":case "k":e=this.getStraightOptions(b,c,1);f=this.getDiagonalOptions(b,
c,1);break;case "Q":case "q":e=this.getStraightOptions(b,c,8);f=this.getDiagonalOptions(b,c,8);break;case "R":case "r":e=this.getStraightOptions(b,c,8);break;case "B":case "b":f=this.getDiagonalOptions(b,c,8);break;case "N":case "n":e=this.getKnightOptions(b,c);break;case "P":case "p":e=this.getPawnOptions(b,c)}for(b=0;b<f.length;b++)e.push(f[b]);return e},getStraightOptions:function(a,c,b){for(var e=!1,f=!1,m=!1,l=!1,k=[],h=1;h<=b;h++)9>c+h&&!e&&(k.push(g.name(a,c+h)),this.board.hasPiece(a,c+h)&&
(e=!0)),9>a+h&&!f&&(k.push(g.name(a+h,c)),this.board.hasPiece(a+h,c)&&(f=!0)),0<c-h&&!m&&(k.push(g.name(a,c-h)),this.board.hasPiece(a,c-h)&&(m=!0)),0<a-h&&!l&&(k.push(g.name(a-h,c)),this.board.hasPiece(a-h,c)&&(l=!0));return k},getDiagonalOptions:function(a,c,b){for(var e=!1,f=!1,m=!1,l=!1,k,h,n=[],p=1;p<=b;p++)9>c+p&&(h=c+p,9>a+p&&!e&&(k=a+p,n.push(g.name(k,h)),this.board.hasPiece(k,h)&&(e=!0)),0<a-p&&!f&&(k=a-p,n.push(g.name(k,h)),this.board.hasPiece(k,h)&&(f=!0))),0<c-p&&(h=c-p,9>a+p&&!m&&(k=a+
p,n.push(g.name(k,h)),this.board.hasPiece(k,h)&&(m=!0)),0<a-p&&!l&&(k=a-p,n.push(g.name(k,h)),this.board.hasPiece(k,h)&&(l=!0)));return n},getKnightOptions:function(a,c){var b=[];0<a-1&&(9>c+2&&b.push(g.name(a-1,c+2)),0<c-2&&b.push(g.name(a-1,c-2)),0<a-2&&(9>c+1&&b.push(g.name(a-2,c+1)),0<c-1&&b.push(g.name(a-2,c-1))));9>a+1&&(9>c+2&&b.push(g.name(a+1,c+2)),0<c-2&&b.push(g.name(a+1,c-2)),9>a+2&&(9>c+1&&b.push(g.name(a+2,c+1)),0<c-1&&b.push(g.name(a+2,c-1))));return b},getPawnOptions:function(a,c){var b=
[];q.isWhite(this.board.getPiece(a,c))?8>c&&(1<a&&b.push(g.name(a-1,c+1)),8>a&&b.push(g.name(a+1,c+1))):1<c&&(1<a&&b.push(g.name(a-1,c-1)),8>a&&b.push(g.name(a+1,c-1)));return b},findPiece:function(a){for(var b=[],d=1;9>d;d++)for(var e=1;9>e;e++)this.board.hasPiece(d,e)&&this.board.getPiece(d,e)==a&&b.push({file:d,rank:e});return b},isSquareAttacked:function(a,b){if(!this.board.hasPiece(a,b))return!1;var d=g.name(a,b),e;e=q.isWhite(this.board.getPiece(a,b))?this.getBlacksCoveredSquares():this.getWhitesCoveredSquares();
for(var f=0;f<e.length;f++)if(e[f]==d)return!0;return!1},isSquareAttackedByWhite:function(a,b){for(var d=g.name(a,b),e=this.getWhitesCoveredSquares(),f=0;f<e.length;f++)if(e[f]==d)return!0;return!1},isSquareAttackedByBlack:function(a,b){for(var d=g.name(a,b),e=this.getBlacksCoveredSquares(),f=0;f<e.length;f++)if(e[f]==d)return!0;return!1},getPositionFEN:function(){if(this.cachedPositionFEN)return this.cachedPositionFEN;for(var a=[],b=8;0<b;b--){for(var d="",e=0,f=1;9>f;f++)this.board.hasPiece(f,b)?
(0<e&&(d+=e,e=0),d+=this.board.getPiece(f,b)):e++;0<e&&(d+=e);a.push(d)}return this.cachedPositionFEN=a.join("/")},setFEN:function(a){this.resetCaches();this.board.setFEN(a)},blackInCheck:function(){var a=this.findPiece("k");return 0==a.length?!1:this.isSquareAttacked(a[0].file,a[0].rank)},whiteInCheck:function(){var a=this.findPiece("K");return 0==a.length?!1:this.isSquareAttacked(a[0].file,a[0].rank)},blackInCheckmate:function(){var a=this.findPiece("k");return 0==a.length?!1:this.isSquareAttacked(a[0].file,
a[0].rank)&&0==this.getValidMovesForSquare(a[0].file,a[0].rank).length},whiteInCheckmate:function(){var a=this.findPiece("K");return 0==a.length?!1:this.isSquareAttacked(a[0].file,a[0].rank)&&0==this.getValidMovesForSquare(a[0].file,a[0].rank).length},moves:function(a){"string"==typeof a&&(a=a.split(" "));for(var b=0;b<a.length;b++)if(!this.move(a[b]))return!1;return!0},move:function(a,b){var d,e,f,m;b=!0===b?!0:!1;d=g.coords(a.substr(0,2));e=g.coords(a.substr(2,2));4<a.length&&a.substr(4,1);if(!this.board.hasPiece(d.file,
d.rank)||!b&&!this.isValidMove(d,e))return!1;f=this.board.getPiece(d.file,d.rank);this.board.removePiece(d.file,d.rank);this.board.setPiece(f,e.file,e.rank);if(("k"==f||"K"==f)&&2==Math.abs(d.file-e.file)){e.file>d.file?(f=e.file+1,m=e.rank,d=e.file-1):(f=e.file-2,m=e.rank,d=e.file+1);e=e.rank;var l=this.board.getPiece(f,m);this.board.removePiece(f,m);this.board.setPiece(l,d,e)}this.board.incrementMove();this.resetCaches();return!0},getWhiteStaticValue:function(){this.determineStaticValues();return this.whiteStaticValue},
getBlackStaticValue:function(){this.determineStaticValues();return this.blackStaticValue},determineStaticValues:function(){if(!(0<this.whiteStaticValue||0<this.blackStaticValue)){this.blackStaticValue=this.whiteStaticValue=0;for(var a,b=1;9>b;b++)for(var d=1;9>d;d++)if(this.board.hasPiece(b,d)){switch(this.board.getPiece(b,d)){case "Q":case "q":a=9;break;case "R":case "r":a=5;break;case "B":case "b":a=3;break;case "N":case "n":a=3;break;case "P":case "p":a=1;break;default:continue}a*=10;q.isWhite(this.board.getPiece(b,
d))?this.whiteStaticValue+=a:this.blackStaticValue+=a}}},getWhiteDynamicValue:function(){this.determineDynamicValues();return this.whiteDynamicValue},getBlackDynamicValue:function(){this.determineDynamicValues();return this.blackDynamicValue},determineDynamicValues:function(){if(!(0<this.whiteDynamicValue||0<this.blackDynamicValue)){this.blackDynamicValue=this.whiteDynamicValue=0;2<=this.findPiece("b").length&&(this.blackDynamicValue+=10);2<=this.findPiece("B").length&&(this.whiteDynamicValue+=10);
var a=this.getBlacksCoveredSquares();this.blackDynamicValue+=Math.round(a.length/1);a=this.getWhitesCoveredSquares();this.whiteDynamicValue+=Math.round(a.length/1)}},getBestMoveForWhite:function(){return this.getBestMove(!0)},getBestMoveForBlack:function(){return this.getBestMove(!1)},getBestMoveSimple:function(a){for(var b=[],d=1;9>d;d++)for(var e=1;9>e;e++)if(this.board.hasPiece(d,e)&&q.isWhite(this.board.getPiece(d,e))==a){var f=this.getValidMovesForSquare(d,e);if(0!=f.length)for(var m=0;m<f.length;m++){var l=
""+g.name(d,e)+f[m].name,k=this.evaluateMove(l);if(1E3==Math.abs(k))return l;b.push({move:l,value:k})}}d=function(a,b){return a.value-b.value};a&&(d=function(a,b){return b.value-a.value});b.sort(d);if(this.mark)for(m=0;m<b.length;m++)console.log(b[m].move+": "+b[m].value);return b[0].move},evaluateMove:function(a){var b=this.clone();b.move(a);return b.evaluatePosition()},clone:function(){var a=EngineFactory.create();a.setFEN(this.getPositionFEN()+" "+(this.board.getColorToMove()==s.white?"w":"b"));
return a}},u,b;r.getBestMove=function(a){this.lastBestMove="";u=this.lastValue=0;b={};var c=(new Date).getTime();this.alphabeta(3,-1E4,1E4,a);c=((new Date).getTime()-c)/1E3;console.log((a?"white":"black")+" to move; examined: "+u+" nodes in "+c+"s ("+Math.round(u/c)+"n/s); best: "+this.lastBestMove+" ("+this.lastValue+")");return this.lastBestMove};r.alphabeta=function(a,c,d,e){u++;var f=this.getPositionFEN()+" "+(this.board.getColorToMove()==s.white?"w":"b"),g;if(0==a){if(b[f])return b[f];g=this.evaluatePosition();
return b[f]=g}var l=this.clone(),k,h;if(e){k=this.getValidMovesForWhite();for(var n=0;n<k.length;n++){l.setFEN(f);l.move(k[n]);h=c;if(l.blackInCheckmate()){c=1E3;this.lastBestMove=k[n];this.lastValue=c;break}else g=l.alphabeta(a-1,c,d,!e),c=Math.max(c,g);h!=c&&(this.lastBestMove=k[n],this.lastValue=g);if(d<=c)break}return c}k=this.getValidMovesForBlack();for(n=0;n<k.length;n++){l.setFEN(f);l.move(k[n]);h=d;if(l.whiteInCheckmate()){d=-1E3;this.lastBestMove=k[n];this.lastValue=d;break}else g=l.alphabeta(a-
1,c,d,!e),d=Math.min(d,g);h!=d&&(this.lastBestMove=k[n],this.lastValue=d);if(d<=c)break}return d};r.evaluatePosition=function(){if(this.whiteInCheckmate())return-1E3;if(this.blackInCheckmate())return 1E3;var a;a=0+this.getWhiteStaticValue();a-=this.getBlackStaticValue();a+=this.getWhiteDynamicValue();return a-=this.getBlackDynamicValue()};EngineFactory=function(){return{create:function(a){"undefined"===typeof a&&(a=BoardFactory.create());return Object.create(r).init(a)}}}()})();
